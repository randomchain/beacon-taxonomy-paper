%!TEX root = ../main.tex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PAGE LAYOUT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{typearea}
\KOMAoptions{ % Basic page layout.
    %draft=true,
    paper=a4,
    abstract=true,
    twoside=true,
    fontsize=11pt,
    numbers=noenddot,
    BCOR=10mm % Margin binding correction
}

% Headers and footers
\usepackage[automark, headsepline=.3pt:head]{scrlayer-scrpage}
\pagestyle{scrheadings}
\ohead{{\MakeUppercase\leftmark}}
\ihead{\rightmark}
\setkomafont{pagehead}{\footnotesize\normalfont\sffamily}
\setkomafont{pagenumber}{\footnotesize\normalfont\sffamily}
\setkomafont{author}{\small\normalfont}
\setkomafont{date}{\small\normalfont}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FONTS, LANGUAGE AND TYPOGRAPHY
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[english]{babel}
\usepackage{fontspec}
\usepackage[T1]{fontenc}

% Fonts
\usepackage[bitstream-charter]{mathdesign} % Serif font
\def\sfdefault{SourceSansPro-TLF} % Sans serif font
\usepackage{inconsolata} % Mono font

% Typographic tweaks
\usepackage[babel]{microtype} % Load after fonts. Yes, may be used with LuaLaTeX

% Space between line commands
\usepackage{setspace}

% Enabling various effects, such as highlightning
\usepackage{soulutf8}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ELEMENTS STYLES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Sections style
\setkomafont{section}{\normalfont\Large\fontseries{k}\sffamily\color{sectioning}}

% Subsections style
\setkomafont{subsection}{\normalfont\large\fontseries{k}\sffamily\color{subsectioning}}

% Subsubsections style
\setkomafont{subsubsection}{\normalfont\normalsize\fontseries{k}\sffamily\color{subsectioning}}

% Descriptions
\renewcommand{\descriptionlabel}[1]{\hspace{\labelsep}\color{descriptionlabeling}\sffamily{\textbf{#1}}}

% Captions
\KOMAoption{captions}{centeredbeside}
\setcapindent{1em}
\setkomafont{captionlabel}{\sffamily\color{sectioning}\bfseries}
\setkomafont{caption}{\sffamily}
\usepackage{subcaption} % Subfigures

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FLOATING ENVIRONMENTS AND LISTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Tables
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{tabularx}
\renewcommand{\arraystretch}{1.1} % Stretch arrays (in tabulars)

\usepackage{enumerate}
\usepackage[inline]{enumitem}
\usepackage{outlines} % Apparently nice for nested lists

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MATH
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsmath}
\usepackage{amsthm}
%\usepackage[group-separator={,}]{siunitx}
\usepackage{fixmath} % Ensures math is typeset according to ISO standard

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MISCELLANEOUS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{multicol}
    \renewcommand{\multicolsep}{\itemsep}
\usepackage[modulo]{lineno}
\usepackage{xspace}
\usepackage{datetime}
\usepackage{fvextra} %Keep this before csquote
\usepackage[autostyle]{csquotes}
\usepackage{glossaries}
\usepackage[super]{nth}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% LATEX BACKGROUND STUFF
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{xargs}
\usepackage{import} % Use relative imports

%Curfile stuff
%We need this to figure out the path if a command doesn't support import
\usepackage{currfile}
\makeatletter
\def\relativepath{\import@path}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% GRAPHICS AND COLORS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Graphics
\usepackage{graphicx}
\graphicspath{{img/}}
\usepackage{rotating}

% Colors
\usepackage[table]{xcolor}
\input{preamble/colors.tex}

% Tikz and pgfplots
\usepackage{tikz}
\usepackage{pgfplots}
\usepgfplotslibrary{external}
%\usepgfplotslibrary{fillbetween}
\pgfplotsset{compat=1.14}
\usetikzlibrary{%
    calc, positioning, fit, arrows.meta
}
\tikzexternalize[prefix=figures/]
\tikzexternalenable{}

\tikzset{every picture/.style={/utils/exec={\sffamily}}}

\tikzstyle{node} = [thick, circle, draw, fill=clnode, text width=1.5em, text centered, minimum height=1.5em]
%\tikzstyle{block-textdepthfix} = [rectangle, draw, thick, fill=clcodeshade, text width=7.5em, text centered, minimum height=3em, text depth=.25ex]
\tikzstyle{block} = [rectangle, draw, thick, fill=clcodeshade, text width=7.5em, text centered, minimum height=3em]
\tikzstyle{arrow} = [draw, -{Stealth[length=2mm, width=2mm]}, thick]

%Two uml packages. I love it
%\usepackage{packages/tikz-uml}
%\usepackage{pgf-umlsd}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SOURCE CODE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Listing & Minted
\usepackage{shellesc}
\usepackage{listings}

%Minted makes nice looking code listings, but requires listings
\usepackage{minted}
\newminted[python]{python}{frame=leftline, framesep=2mm, linenos, fontsize=\footnotesize, baselinestretch=1.1, autogobble}
\usepackage{tcolorbox}

\usepackage{mdframed}
\mdfsetup{topline=false, rightline=false, leftline=false, bottomline=false}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FixMe
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{fixme}
\fxsetup{%
    status=draft,
    footnote=false,
    inline=true,
    margin=false,
    marginclue=true,
    theme=colorsig,
    mode=multiuser,
    silent=true
}

\FXRegisterAuthor{msm}{msme}{Michno}
\FXRegisterAuthor{mtj}{mtje}{Michael}
\FXRegisterAuthor{srk}{srke}{Sebastian}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BIBLIOGRAPHY
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[
    style=numeric,
    maxnames=1,
    backend=biber,
    defernumbers=true,
    hyperref=true,
    alldates=long,
    natbib=true
]{biblatex}
\bibliography{bibtex.bib}

\setcounter{biburlnumpenalty}{300} % Enable breaking URLs in bibliography after numbers
\setcounter{biburlucpenalty}{300} % Enable breaking URLs in bibliography after uppercase letters
\setcounter{biburllcpenalty}{300} % Enable breaking URLs in bibliography after lowercase letters


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% References
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[english]{varioref} % \vref, if a thing is referred on another page.
\usepackage{hyperref} % Load late
\hypersetup{
    bookmarksnumbered,
    bookmarksdepth=1,
    pdfauthor={\GROUP},
    pdftitle={\TITLE},
    pdfpagelayout=TwoColumnLeft,
    pdfdisplaydoctitle,
    breaklinks,
    linktoc=all,
    pdfprintscaling=None,
    %plainpages=false,
    colorlinks,
    linkcolor=aaublue,
    citecolor=aaublue,
    urlcolor=aaublue,
    filecolor=aaublue
}

\usepackage[english, capitalise, noabbrev, nameinlink]{cleveref} % Load late
\crefname{appchap}{appendix}{appendices}
\Crefname{appchap}{Appendix}{Appendices}

% For refs to description itmes
\makeatletter
\def\namedlabel#1#2{\begingroup
    #2%
    \def\@currentlabel{#2}%
    \phantomsection\label{#1}\endgroup
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% EXTERNAL FILES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{preamble/commands.tex}
\input{preamble/latexdiff.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MISCELLANEOUS TO BE LOADED LAST
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{scrhack} % Load very, very late. Renews commands.

